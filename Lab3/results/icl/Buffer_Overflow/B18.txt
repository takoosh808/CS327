V1 (secure):
/* V1 - secure: uses strncat with explicit size limits */
#include <stdio.h>
#include <string.h>
void safe_insert(char *buf, size_t bufsize, const char *ins) {
    size_t cur = strlen(buf);
    strncat(buf, ins, bufsize - cur - 1);
}
V2 (vulnerable):
/* V2 - vulnerable: replaced strncat with strcat (no bounds checking) */
#include <stdio.h>
#include <string.h>
void safe_insert(char *buf, size_t bufsize, const char *ins) {
    /* Buffer overflow injected: strcat does not check the destination buffer size */
    strcat(buf, ins); /* vulnerable */
}